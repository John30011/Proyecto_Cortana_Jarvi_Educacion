# üìö Resumen del Proyecto GEMINI

## üìÖ √öltima Actualizaci√≥n: 30 de Junio de 2025

## üé® Mejoras Recientes en el Frontend

### üîí Configuraci√≥n de Seguridad
- Implementada Pol√≠tica de Seguridad de Contenido (CSP) para:
  - Permitir contenido multimedia de Google Video y YouTube
  - Habilitar iframes de YouTube
  - Permitir conexiones seguras a servidores de video de Google
  - Configuraci√≥n realizada en `vite.config.ts` usando `vite-plugin-html`

### üîê Autenticaci√≥n de Usuarios
- Implementaci√≥n de botones de autenticaci√≥n en el encabezado
  - Bot√≥n "Iniciar Sesi√≥n" con estilo outline
  - Bot√≥n "Registrarse" con estilo s√≥lido
  - Dise√±o responsive y adaptativo al tema claro/oscuro
  - Rutas configuradas para el flujo de autenticaci√≥n

### üñºÔ∏è Actualizaci√≥n de Im√°genes
- Se reemplazaron todas las im√°genes de marcador de posici√≥n por im√°genes profesionales de alta calidad
- Im√°genes optimizadas para web con carga r√°pida
- Tem√°tica consistente en todo el sitio

### üé• Integraci√≥n de Videos
- Se implement√≥ reproductor de video embebido de YouTube
- Videos configurados con autoplay, mute y loop para la secci√≥n hero
- Secci√≥n de demostraci√≥n con video explicativo

### üé® Mejoras de UI/UX
- Dise√±o responsivo que se adapta a diferentes tama√±os de pantalla
- Transiciones suaves y animaciones con Framer Motion
- Paleta de colores consistente con la identidad de la marca
- Tipograf√≠a mejorada para mejor legibilidad

### üõ†Ô∏è Optimizaciones T√©cnicas
- C√≥digo refactorizado para mejor mantenibilidad
- Tipos de TypeScript mejorados
- Eliminaci√≥n de c√≥digo duplicado
- Mejor manejo de estados y efectos

## üìå Visi√≥n General
Plataforma educativa interactiva para ni√±os de 3 a 12 a√±os que combina aprendizaje con diversi√≥n mediante juegos, actividades interactivas y un asistente educativo inteligente.

## üéØ Caracter√≠sticas Principales

### Para Ni√±os
- **M√≥dulos Educativos** adaptados por edades (3-5, 6-8, 9-12 a√±os)
- **Chatbot Interactivo** con IA para aprendizaje personalizado
- **Sistema de Recompensas** con logros y stickers educativos
- **Interfaz Amigable** dise√±ada espec√≠ficamente para ni√±os
- **M√∫ltiples Materias**: Matem√°ticas, Ciencia, Historia, Salud, Deportes, Valores Espirituales

### Para Padres
- **Panel de Control** para seguimiento del progreso
- **Contenido Supervisado** y seguro para ni√±os
- **Reportes de Actividad** detallados

## üöÄ Activaci√≥n de Servicios

### Configuraci√≥n del Entorno (28/06/2024)

#### Dependencias Instaladas
- **Python**: 3.9.12
- **Poetry**: 2.1.3
- **MongoDB**: En ejecuci√≥n en localhost:27017
- **Dependencias principales**:
  - fastapi==0.95.2
  - pydantic==1.10.12
  - uvicorn==0.24.0.post1
  - pymongo==4.13.2
  - python-jose==3.5.0
  - email-validator==2.2.0

#### Configuraci√≥n del Entorno
Se cre√≥ y configur√≥ el archivo `.env` con la configuraci√≥n de conexi√≥n a MongoDB y par√°metros de la aplicaci√≥n.

#### Soluci√≥n de Problemas
1. **Error de dependencia faltante**: Se instal√≥ manualmente `email-validator`
2. **Conflicto de versiones**: Se ajustaron las versiones de las dependencias para evitar conflictos

## üë• Usuarios de Prueba Creados (28/06/2024)

### Usuarios Creados Exitosamente:

1. **Usuario Administrador**
   - **Usuario**: adminuser
   - **Rol**: admin
   - **Grupo de edad**: 9-12
   - **Estado**: Creado exitosamente (201)

2. **Usuario Ni√±o (6-8 a√±os)**
   - **Usuario**: nino2
   - **Rol**: child
   - **Grupo de edad**: 6-8
   - **Estado**: Creado exitosamente (201)

3. **Usuario Ni√±o (9-12 a√±os)**
   - **Usuario**: nino3
   - **Rol**: child
   - **Grupo de edad**: 9-12
   - **Estado**: Creado exitosamente (201)

4. **Usuario Padre/Madre**
   - **Usuario**: padre1
   - **Rol**: parent
   - **Grupo de edad**: 9-12
   - **Estado**: Creado exitosamente (201)

5. **Usuario Profesor**
   - **Usuario**: profesor1
   - **Rol**: teacher
   - **Grupo de edad**: 9-12
   - **Estado**: Creado exitosamente (201)

### Usuario con Error:
- **Usuario**: nino1
- **Rol**: child
- **Grupo de edad**: 3-5
- **Estado**: Error en el registro (problema con caracteres especiales en PowerShell)

### Notas:
- Las contrase√±as siguen el formato requerido: may√∫sculas, min√∫sculas, n√∫meros y caracteres especiales.
- Los usuarios est√°n listos para ser utilizados en el sistema.

## üöÄ Activaci√≥n de Servicios

### Backend
1. **Requisitos**:
   - Python 3.13
   - MongoDB Atlas configurado
   - Variables de entorno en `.env`

2. **Instalaci√≥n**:
   ```bash
   cd backend
   poetry install
   ```

3. **Iniciar** (puerto 8000):
   ```bash
   python -m uvicorn main:app --reload --host 127.0.0.1 --port 8000
   ```
   - Documentaci√≥n: http://127.0.0.1:8000/docs
   - Estado: http://127.0.0.1:8000/api/v1/health

### Frontend
1. **Requisitos**:
   - Node.js 18+ y npm 9+
   - Backend en ejecuci√≥n

2. **Instalaci√≥n**:
   ```bash
   cd frontend
   npm install
   ```

3. **Iniciar** (puerto 3001):
   ```bash
   npm run dev
   ```
   - URL: http://localhost:3001

## üõ†Ô∏è Stack Tecnol√≥gico

### Frontend
- **Framework**: React 18 + Vite
- **Estilos**: Tailwind CSS + Framer Motion
- **Estado**: React Context API
- **Enrutamiento**: React Router v6
- **Formularios**: React Hook Form
- **Validaci√≥n**: Zod

### Backend
- **Framework**: FastAPI (Python 3.9+)
- **Base de Datos**: MongoDB
- **Autenticaci√≥n**: JWT con refresh tokens
- **Documentaci√≥n**: Swagger UI y ReDoc
- **WebSockets**: Para funcionalidades en tiempo real

### IA y Procesamiento
- **Chatbot**: Integraci√≥n con modelos de lenguaje
- **Recomendaciones**: Basadas en el progreso y preferencias

## üîê Seguridad
- Autenticaci√≥n JWT con refresh tokens
- Cookies HTTP-only seguras
- Validaci√≥n de entrada estricta
- CORS configurado
- Contenido supervisado y apropiado para cada edad

## üåø Flujo de Trabajo Git

### Ramas Principales
1. **`main`**
   - Versi√≥n estable en producci√≥n
   - Solo se actualiza mediante Pull Requests aprobados
   - Cada commit debe ser una versi√≥n desplegable

2. **`develop`**
   - Rama de integraci√≥n para caracter√≠sticas
   - Contiene el c√≥digo para la pr√≥xima versi√≥n
   - Se sincroniza regularmente con `main`

### Ramas de Soporte
1. **`feature/*`**
   - Para desarrollar nuevas funcionalidades
   - Se crean desde `develop`
   - Se fusionan de vuelta a `develop`

2. **`hotfix/*`**
   - Para correcciones cr√≠ticas en producci√≥n
   - Se crean desde `main`
   - Se fusionan a `main` y `develop`

3. **`release/*`**
   - Para preparar lanzamientos
   - Se crean desde `develop`
   - Se fusionan a `main` (con tag) y `develop`

## üöÄ Estado Actual del Proyecto

### üîÑ Cambios Recientes (Junio 2024)

#### 1. Backend (FastAPI)
- **Configuraci√≥n**:
  - Actualizado `config.py` con variables para tokens de actualizaci√≥n
  - A√±adida configuraci√≥n de expiraci√≥n y seguridad

- **Endpoints**:
  - `/auth/token`: Inicio de sesi√≥n con access y refresh tokens
  - `/auth/refresh-token`: Renovaci√≥n de access token
  - `/auth/logout`: Cierre de sesi√≥n con revocaci√≥n de tokens
  - `/auth/me`: Informaci√≥n del usuario autenticado

- **Seguridad**:
  - Validaci√≥n de tokens implementada
  - Sistema de revocaci√≥n de tokens
  - Manejo de cookies HTTP-only seguras

#### 2. Frontend (React)
- Eliminada variable no utilizada `bgGradient` en `Home.tsx`

#### 3. Pruebas
- A√±adidas pruebas de integraci√≥n para autenticaci√≥n
- Verificaci√≥n de renovaci√≥n de tokens
- Pruebas de cierre de sesi√≥n

#### 4. Documentaci√≥n
- Actualizado README.md con documentaci√≥n de la API
- Incluidos ejemplos de solicitudes y respuestas

### ‚úÖ Completado
1. **Autenticaci√≥n**
   - Registro e inicio de sesi√≥n de usuarios
   - Renovaci√≥n de tokens JWT
   - Cierre de sesi√≥n con revocaci√≥n de tokens
   - Protecci√≥n de rutas

2. **Estructura del Proyecto**
   - Configuraci√≥n inicial de frontend y backend
   - Estructura de carpetas organizada
   - Variables de entorno configuradas

3. **Interfaz de Usuario**
   - P√°gina de inicio
   - Componentes base
   - Dise√±o responsivo

### üöß En Progreso
1. **M√≥dulos Educativos**
   - Matem√°ticas b√°sicas
   - Ciencias naturales
   - Valores espirituales

2. **Chatbot Educativo**
   - Integraci√≥n con IA
   - Respuestas contextuales
   - Personalizaci√≥n por edad

3. **Panel de Padres**
   - Seguimiento de progreso
   - Configuraci√≥n de controles parentales

## üõ†Ô∏è Soluci√≥n de Problemas Recientes

### Registro de Usuarios (28/06/2024)
- **Problema**: Error 500 al registrar nuevos usuarios
- **Causa**: Incompatibilidad entre el formato de `_id` de MongoDB y el modelo Pydantic
- **Soluci√≥n**:
  1. Ajuste en el modelo `UserResponse` para manejar correctamente el alias `_id`
  2. Modificaci√≥n del endpoint de registro para asegurar la inclusi√≥n del campo `_id`
  3. Conversi√≥n expl√≠cita de `ObjectId` a string en el repositorio de usuarios
- **Archivos modificados**:
  - `backend/app/models/user.py`
  - `backend/app/api/v1/endpoints/auth.py`
  - `backend/app/repositories/user_repository.py`

## üåê Documentaci√≥n de la API

### üîê Autenticaci√≥n

#### `POST /api/v1/auth/register`
- **Descripci√≥n**: Registra un nuevo usuario en el sistema
- **Autenticaci√≥n**: No requerida
- **Body**: `{ "username": "string", "email": "string", "password": "string" }`
- **Respuesta exitosa (201)**: `{ "id": "string", "username": "string", "email": "string" }`

#### `POST /api/v1/auth/login`
- **Descripci√≥n**: Inicia sesi√≥n y obtiene tokens de acceso
- **Autenticaci√≥n**: Basic Auth (usuario/contrase√±a)
- **Form-Data**: `username`, `password`
- **Respuesta exitosa (200)**: 
  ```json
  {
    "access_token": "string",
    "refresh_token": "string",
    "token_type": "bearer"
  }
  ```

#### `GET /api/v1/auth/me`
- **Descripci√≥n**: Obtiene informaci√≥n del usuario actual
- **Autenticaci√≥n**: Requerida (JWT)
- **Headers**: `Authorization: Bearer <token>`
- **Respuesta exitosa (200)**: Informaci√≥n del usuario autenticado

#### `POST /api/v1/auth/logout`
- **Descripci√≥n**: Cierra la sesi√≥n del usuario actual
- **Autenticaci√≥n**: Requerida (JWT)
- **Headers**: `Authorization: Bearer <token>`
- **Respuesta exitosa (200)**: `{ "message": "Sesi√≥n cerrada exitosamente" }`

#### `POST /api/v1/auth/refresh-token`
- **Descripci√≥n**: Obtiene un nuevo token de acceso
- **Autenticaci√≥n**: Refresh token en el header
- **Headers**: `Authorization: Bearer <refresh_token>`
- **Respuesta exitosa (200)**: Nuevo access token

### üß™ Endpoints de Prueba

#### `GET /api/v1/ping`
- **Descripci√≥n**: Verifica que la API est√° funcionando
- **Autenticaci√≥n**: No requerida
- **Respuesta exitosa (200)**: `{ "message": "¬°La API de GEMINI est√° funcionando correctamente!" }`

#### `GET /api/v1/secure-ping`
- **Descripci√≥n**: Verifica la autenticaci√≥n del usuario
- **Autenticaci√≥n**: Requerida (JWT)
- **Headers**: `Authorization: Bearer <token>`
- **Respuesta exitosa (200)**: Informaci√≥n del usuario autenticado

### üìö Documentaci√≥n

- **Swagger UI**: `http://localhost:8000/docs`
- **ReDoc**: `http://localhost:8000/redoc`
- **OpenAPI Schema**: `http://localhost:8000/openapi.json`

## üìÇ Estructura del Proyecto

```
Agente-Educador/
‚îú‚îÄ‚îÄ backend/               # Backend FastAPI
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/           # Endpoints de la API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ core/          # Configuraciones centrales
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ db/            # Conexi√≥n a base de datos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/        # Modelos Pydantic
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ schemas/       # Esquemas de validaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ tests/             # Pruebas
‚îÇ   ‚îî‚îÄ‚îÄ main.py            # Punto de entrada
‚îÇ
‚îú‚îÄ‚îÄ frontend/             # Frontend React
‚îÇ   ‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îî‚îÄ‚îÄ src/
‚îÇ       ‚îú‚îÄ‚îÄ assets/       # Recursos est√°ticos
‚îÇ       ‚îú‚îÄ‚îÄ components/    # Componentes reutilizables
‚îÇ       ‚îú‚îÄ‚îÄ pages/         # P√°ginas de la aplicaci√≥n
‚îÇ       ‚îú‚îÄ‚îÄ services/      # Llamadas a la API
‚îÇ       ‚îî‚îÄ‚îÄ App.tsx        # Componente principal
‚îÇ
‚îú‚îÄ‚îÄ docker/               # Configuraciones de Docker
‚îú‚îÄ‚îÄ docs/                 # Documentaci√≥n adicional
‚îî‚îÄ‚îÄ .github/              # Configuraci√≥n de GitHub
```

## üîÑ Flujo de Autenticaci√≥n

### Inicio de Sesi√≥n
1. El usuario ingresa credenciales
2. El servidor valida y devuelve tokens de acceso y actualizaci√≥n
3. Los tokens se almacenan en cookies HTTP-only seguras

### Acceso a Recursos
1. El cliente env√≠a el token de acceso en el encabezado Authorization
2. El servidor valida el token y sirve el recurso solicitado

### Renovaci√≥n de Token
1. Cuando el token de acceso expira, el cliente usa el refresh token
2. El servidor emite nuevos tokens si el refresh token es v√°lido

### Cierre de Sesi√≥n
1. Los tokens se revocan en el servidor
2. Las cookies se eliminan del navegador

## üìä Base de Datos

### Colecciones Principales
1. **users**
   - Informaci√≥n de usuarios (ni√±os y padres)
   - Credenciales de autenticaci√≥n
   - Preferencias y configuraci√≥n

2. **modules**
   - Contenido educativo por materia y edad
   - Actividades y ejercicios
   - Metadatos de progreso

3. **sessions**
   - Registro de sesiones de usuario
   - Actividad y m√©tricas

4. **tokens**
   - Tokens revocados
   - Historial de autenticaci√≥n

## üìù Documentaci√≥n de la API

### Autenticaci√≥n
- `POST /api/v1/auth/register` - Registrar nuevo usuario
- `POST /api/v1/auth/token` - Iniciar sesi√≥n
- `POST /api/v1/auth/refresh-token` - Renovar token de acceso
- `POST /api/v1/auth/logout` - Cerrar sesi√≥n
- `GET /api/v1/auth/me` - Obtener informaci√≥n del usuario actual

### Usuarios
- `GET /api/v1/users` - Listar usuarios (admin)
- `GET /api/v1/users/me` - Perfil del usuario actual
- `PUT /api/v1/users/me` - Actualizar perfil

### M√≥dulos
- `GET /api/v1/modules` - Listar m√≥dulos disponibles
- `GET /api/v1/modules/{id}` - Obtener m√≥dulo por ID
- `GET /api/v1/modules/{id}/activities` - Actividades del m√≥dulo

## üöÄ Despliegue

### Requisitos
- Servidor con Docker y Docker Compose
- Dominio con certificado SSL

### Pasos
1. Configurar variables de entorno
2. Iniciar servicios con Docker Compose
3. Configurar proxy inverso (Nginx/Apache)
4. Configurar certificados SSL (Let's Encrypt)

## üîç Pr√≥ximos Pasos

### Inmediato
- [x] Ejecutar pruebas de integraci√≥n
- [ ] Implementar renovaci√≥n autom√°tica de tokens en frontend
- [ ] Revisar configuraci√≥n de CORS y pol√≠ticas de seguridad
- [ ] A√±adir logs detallados para auditor√≠a

### Corto Plazo
- [ ] Completar m√≥dulo de matem√°ticas
- [ ] Implementar sistema de logros
- [ ] A√±adir m√°s actividades interactivas

### Largo Plazo
- [ ] Aplicaci√≥n m√≥vil nativa
- [ ] Soporte para m√∫ltiples idiomas
- [ ] Integraci√≥n con plataformas educativas

## ü§ù Contribuci√≥n

1. Hacer fork del repositorio
2. Crear una rama para la caracter√≠stica (`git checkout -b feature/amazing-feature`)
3. Hacer commit de los cambios (`git commit -m 'Add some amazing feature'`)
4. Hacer push a la rama (`git push origin feature/amazing-feature`)
5. Abrir un Pull Request

## üìÑ Licencia

Este proyecto est√° bajo la Licencia MIT. Ver el archivo [LICENSE](LICENSE) para m√°s detalles.

---

*√öltima actualizaci√≥n: 27 de junio de 2024*
